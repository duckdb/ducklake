# name: test/sql/attach/different_paths.test
# description: test attach of ducklake when providing different paths
# group: [attach]

require ducklake

require parquet

test-env DUCKLAKE_CONNECTION __TEST_DIR__/{UUID}.db

test-env DATA_PATH __TEST_DIR__

statement ok
ATTACH 'ducklake:${DUCKLAKE_CONNECTION}' AS a_ducklake (DATA_PATH '${DATA_PATH}/some/');

statement ok
USE a_ducklake;

statement ok
CREATE TABLE t AS SELECT range a FROM range(10);

statement ok
USE memory;

statement ok
DETACH a_ducklake;

statement error
ATTACH 'ducklake:${DUCKLAKE_CONNECTION}' AS other_ducklake (DATA_PATH '${DATA_PATH}/other_path/');
----
does not match existing data path in the catalog

statement ok
ATTACH 'ducklake:${DUCKLAKE_CONNECTION}' AS other_ducklake (DATA_PATH '${DATA_PATH}/other_path/', OVERRIDE_DATA_PATH TRUE);

# This will obviously not work, different OSs have different error messages saying file not found
statement error
FROM other_ducklake.t;
----
